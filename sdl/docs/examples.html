<!--
Google IO 2012 HTML5 Slide Template

Authors: Eric Bidelman <ebidel@gmail.com>
         Luke Mahé <lukem@google.com>

URL: https://code.google.com/p/io-2012-slides
-->
<!DOCTYPE html>
<html>
<head>
  <title>Presentation</title>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="chrome=1">
  <!--<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0">-->
  <!--<meta name="viewport" content="width=device-width, initial-scale=1.0">-->
  <!--This one seems to work all the time, but really small on ipad-->
  <!--<meta name="viewport" content="initial-scale=0.4">-->
  <meta name="apple-mobile-web-app-capable" content="yes">
  <link rel="stylesheet" media="all" href="css/default.css">
  <link rel="stylesheet" media="only screen and (max-device-width: 480px)" href="css/phone.css">
  <base target="_blank"> <!-- This amazingness opens all links in a new tab. -->
  <script data-main="js/slides" src="js/require-1.0.8.min.js"></script>
</head>
<body style="opacity: 0">

<slides class="layout-widescreen">

  <slide class="logoslide nobackground">
    <article class="flexbox vcenter">
      <span><img src="images/google_developers_logo.png"></span>
    </article>
  </slide>

  <slide class="title-slide segue nobackground">
    <aside class="gdbar"><img src="images/google_developers_icon_128.png"></aside>
    <!-- The content of this hgroup is replaced programmatically through the slide_config.json. -->
    <hgroup class="auto-fadein">
      <h1 data-config-title><!-- populated from slide_config.json --></h1>
      <h2 data-config-subtitle><!-- populated from slide_config.json --></h2>
      <p data-config-presenter><!-- populated from slide_config.json --></p>
    </hgroup>
  </slide>

  
<slide>
<hgroup>
<p>| Title    | Survey Domain Language Examples          |
|----------|------------------------------------------|
| Author   | Rafał Korzeniewski                       |
| email    | korzeniewski@gmail.com                   |
| web      | http://rkorzen.pythonanywhere.com/parser |
| Date:    | Jun 20, 2016                             | 
| Version  | 0.01                                     |</p>
</hgroup>
<article class="none">
<h1>Change Log</h1>
<p>| Data       | Version | Description                                       | Author             |
|------------|---------|---------------------------------------------------|--------------------|
| 20.06.2016 | 1.00    | Create Document                                   | Rafał Korzeniewski |</p>
<h2>Survey Parser</h2>
<h1>INDEX</h1>
<!-- MarkdownTOC autolink=true autoanchor=true bracket=round depth=5 -->

<ul>
<li><a href="#base-concepts">Base Concepts</a><ul>
<li><a href="#why-webapp">Why WebApp?</a></li>
</ul>
</li>
<li><a href="#case-study">Case study.</a></li>
<li><a href="#pressuppositons">Pressuppositons:</a></li>
<li><a href="#ibm-base-proffesional-examples">IBM Base Proffesional examples</a><ul>
<li><a href="#basic-question-types-and-definitions">Basic question types and definitions</a><ul>
<li><a href="#simple-list-definition">Simple list definition</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<!-- /MarkdownTOC -->

<p><a name="base-concepts"></a></p>
<h1>Base Concepts</h1>
<p>The base concept which is behind this soft is to safely automattion of processing the questionnaire to script.
I assumed that it will be difficult to enforce a particular shape of questionnaire. One of them will be in doc, others in xls, sometimes odf, pdf, other text format. Some will contain complex formatting, others do not.</p>
<p>I came to the conclusion that formatting should be done by scripter.Doszedłem do wniosku</p>
<p>This process must be on the one hand as simple as possible. On the other hand, there must be possible to enter as much information as possible.</p>
<p>How it looks now?
0. After receiving the questionnaire, I try to replace editor formatting to html formatting (bold, italics). In word i have a special macro for this.</p>
<ol>
<li>Copying text to the editor - for example Notepad ++, sublime, or another text editor</li>
<li>Start to reformatting. Usually it means that I add a question type, some special markers. Set answerws cafeteria before statements cafeteria and separate them, add precode, postcode.</li>
<li>Paste this input into webapp choose type of output and get it. </li>
<li>Paste it to the mdd metadata or routing</li>
</ol>
<p><a name="why-webapp"></a></p>
<h3>Why WebApp?</h3>
<p>I think it is maybe not the best way. But for sure it is simplest.
Go to the web page, paste input, get result.
You do not need to install anything, etc.</p>
<p>WebApp is not only one way that SDL can be used.</p>
<p><a name="case-study"></a></p>
<h1>Case study.</h1>
<p>Recently I received survey where some parts were in word documents, and other parts (long lists i.e.) in excel.
Here is how I can handle something similar with it using SDL.</p>
<p>DOC content:</p>
<pre><code>Q1. What is Yours favorite car brand
[Scripter: single answer, list in columns, sort it alphabeticaly]
1   ALFA ROMEO
...
69  SSANGYONG
70  DODGE
71  BUGATTI
72  ACURA
             98. No one  [screenout]
Q2 Which models of [brand] are the best
[Scrpiter: list of models in excel files – sort it alpabetically, ask only for brand from Q1]

Q3 Which car brand you never would have bought 
[Scripter: list from Q1]
</code></pre>
<p>DOC after doc makro:</p>
<pre><code>Q1. What is Yours &lt;b&gt;favorite car brand&lt;/b&gt;
[Scripter: single answer, list in columns, sort it alphabeticaly]
1   ALFA ROMEO
2   AUDI
...
69  SSANGYONG
70  DODGE
71  BUGATTI 
72  ACURA
98. No one  [screenout]
Q2 Which models of &lt;b&gt;[brand]&lt;/b&gt; are the best
[Scrpiter: list of models in excel files – sort it alpabetically]

Q3 Which car &lt;b&gt;brand&lt;/b&gt; you &lt;b&gt;never would have bought&lt;/b&gt; 
[Scripter: list from Q1]
</code></pre>
<p>and here we have SDL input
I think - for now it's one of the most advanced examples, because there is a concept of nesting Python scripts.</p>
<pre><code>Q S Q1 What is Yours &lt;b&gt;favorite car brand&lt;/b&gt; --sort --list:carBrands --listcolumn:3 
1    ALFA ROMEO
...
69    SSANGYONG
70    DODGE
71    BUGATTI
72    ACURA

BEGIN PROGRAM
import csv
from collections import OrderedDict

container = OrderedDict()

# just copy this from excel,
car_models = """brand    brand_id    model    model_id
ALFA ROMEO    1    no model    0
ALFA ROMEO    1    inne modele    1
...
DODGE    70    CALIBER    31
BUGATTI    71    no model    0
ACURA    72    no model    0
"""

def q2_questions(car_models):

    out = ""
    listy_marek = OrderedDict()

    models = csv.DictReader(car_models, delimiter="\t")

    for m in models:
        if m["brand_id"] in listy_marek.keys():
            listy_marek[m["brand_id"]].append(m["model_id"], m["model"]])
        else:
            listy_marek[m["brand_id"]] = []
            listy_marek[m["brand_id"]].append(m["model_id"], m["model"]])

    for key in listy_marek.keys():
        out += """
Q M Q2_{0} Which models of &lt;b&gt;[brand]&lt;/b&gt; are the best
PRE 'if A3.ContainsAny("_{0}") then A4_{0}.Ask()
""".format(key)
        listy = sorted(listy_marek[key], key=lambda x: x[1] )
        for el in listy:
            out += """0] + " " + el[1]            
96.c Other... 
97.d Don't know
""".format(el[0], el[1])

xxx = q1_questions(car_models)  # function call

END PROGRAM

Q3 Which car &lt;b&gt;brand&lt;/b&gt; you &lt;b&gt;never would have bought&lt;/b&gt; 
--use: carBrands
</code></pre>
<p>metadata output:</p>
<pre><code>carBrands - define
{
    _72 "ACURA",
    _1 "ALFA ROMEO",
    _38 "ARO",
    ...
    _57 "WOŁGA",
    _58 "YUGO",
    _59 "ZAPOROŻEC",
    _60 "ŻUK"

};

Q1 "What is Yours &lt;b&gt;favorite car brand&lt;/b&gt;   "
Categorical [1..1]
{
    use carBrands -
};

Q2_1 "Which models of &lt;b&gt;ALFA ROMEO&lt;/b&gt; are the best"
Categorical [1..]
{
    _32 "145",
    _41 "146",
    _44 "147",
    _42 "155",
    _43 "156",
    _45 "159",
    _51 "164",
    _52 "166",
    _31 "33",
    _75 "4C",
    _20 "70",
    _74 "BRERA",
    _73 "GT",
    _72 "GTV",
    _33 "GULIETTA",
    _21 "MITO",
    _71 "SPIDER",
    _1 "inne modele",
    _0 "no model",
    _96 "Other..." other,
    - "Don't know" DK

};

Q2_2 "Which models of &lt;b&gt;AUDI&lt;/b&gt; are the best"
Categorical [1..]
{
    _52 "100/100 QUATTRO",
    _62 "200/200 QUATTRO",
    _42 "80",
    _44 "80/90 QUATTRO",
    _43 "90",
    _21 "A1",
    _32 "A2",
    _31 "A3",
    _41 "A4/S4",
    _54 "A5/S5",
    _51 "A6/S6",
    _55 "A7",
    _61 "A8/S8",
    _53 "ALLROAD",
    _91 "Q3",
    _92 "Q5",
    _93 "Q7",
    _72 "R8",
    _71 "TT",
    _1 "inne modele",
    _0 "no model",
    _96 "Other..." other,
    - "Don't know" DK

};

...

Q2_69 "Which models of &lt;b&gt;SSANGYONG&lt;/b&gt; are the best"
Categorical [1..]
{
    _93 "ACTYON",
    _94 "ACTYON SPORT",
    _95 "CORANDO",
    _92 "KORON",
    _91 "REXTON",
    _81 "RODIUS",
    _1 "inne modele",
    _0 "no model",
    _96 "Other..." other,
    - "Don't know" DK

};

Q2_70 "Which models of &lt;b&gt;DODGE&lt;/b&gt; are the best"
Categorical [1..]
{
    _31 "CALIBER",
    _96 "Other..." other,
    - "Don't know" DK

};

Q2_71 "Which models of &lt;b&gt;BUGATTI&lt;/b&gt; are the best"
Categorical [1..]
{
    _0 "no model",
    _96 "Other..." other,
    - "Don't know" DK

};

Q2_72 "Which models of &lt;b&gt;ACURA&lt;/b&gt; are the best"
Categorical [1..]
{
    _0 "no model",
    _96 "Other..." other,
    - "Don't know" DK

};

Q3 "Which car &lt;b&gt;brand&lt;/b&gt; you &lt;b&gt;never would have bought&lt;/b&gt;"
Categorical [1..]
{
    use  carBrands -

};
</code></pre>
<p>And web routing out - of course there is a bug - because filter is commented and there
shouldn't be asks outside. 
Web routing part is usually shorter. And here we have some logic to script. 
I think its better to prepare only a scratch of this part
web routing out</p>
<pre><code>Q1.Ask()

'if A3.ContainsAny("_1") then A4_1.Ask()
Q2_1.Ask()
'if A3.ContainsAny("_2") then A4_2.Ask()
Q2_2.Ask()
'if A3.ContainsAny("_3") then A4_3.Ask()
Q2_3.Ask()
...
'if A3.ContainsAny("_70") then A4_70.Ask()
Q2_70.Ask()
'if A3.ContainsAny("_71") then A4_71.Ask()
Q2_71.Ask()
'if A3.ContainsAny("_72") then A4_72.Ask()
Q2_72.Ask()
Q3.Ask()
</code></pre>
<p><a name="pressuppositons"></a></p>
<h1>Pressuppositons:</h1>
<p>There are few simple rules to remember. </p>
<p>I. When You create question syntax is always build like this:</p>
<pre><code>1 2     3   4                                                                     5
Q QTYPE QID Question content (for now it should be at one line. Html is allowed.) --special_markers

1: Q - this mean that there will be a question definition. In other systems there can be also B for block, P for page.
2: QTYPE - S|M|L|N|O|LHS|B|SDG|T|G|SLIDER|SLIDERS|H|R|CS|DEF
           S - Single
           M - Multi
           L - Page without form - just a text information
           N - Numeric
           O - Open (Text)
           LHS - love hate scale
           B - Baskets
           SDG - Simple Dynamic Grid
           T - Table
           G - Grid
           SLIDER
           SLIDERS
           H - Highlighter
           R - Rank
           CS - Concept select
           DEF - list definition
3: QID - just an ID of question
4: Content
5: Special markers:

    --multi                 : multianswer in grids, tables
    --images                : image cafeteria
    --listcolumn            : cafeteria in columns
    --dezaktywacja          :
    --minchoose:x           : multi min choose
    --maxchoose:x           : multi max choose
    --nr                    : not require
    --int-implicite         : don't use first digit as a id (see [example]())
    --big-letters
    --lz:numbers            : add lead zeros to id

    IBIS
    --custom_css            : add custom css to page

    Dimensions
    --list:name             : define and use cafeteria object
    --use:name              : use cafeteria object
</code></pre>
<p><a name="ibm-base-proffesional-examples"></a></p>
<h1>IBM Base Proffesional examples</h1>
<p><a name="basic-question-types-and-definitions"></a></p>
<h2>Basic question types and definitions</h2>
<p><a name=""></a>
<a name="simple-list-definition"></a></p>
<h3>Simple list definition</h3>
<p>Here is how a list can be defined explicite.
It's possible to define a list implicite, i.e. when a categorical question is created</p>
<p>Explicite</p>
<p>input:</p>
<pre><code>Q DEF Brands Brands
2   a
5   b
7   c
</code></pre>
<p>double "Brands" it's artefact. It's possible to fix this in future iterations.</p>
<p>metadata output:</p>
<pre><code>Brands - define
{
    _1 "a",
    _2 "b",
    _3 "c"

};
</code></pre>
<p>routing output:</p>
<pre><code>None
</code></pre>
</article>
</slide>



  <slide class="backdrop"></slide>

</slides>

<!--[if IE]>
  <script src="http://ajax.googleapis.com/ajax/libs/chrome-frame/1/CFInstall.min.js"></script>
  <script>CFInstall.check({mode: 'overlay'});</script>
<![endif]-->
</body>
</html>
